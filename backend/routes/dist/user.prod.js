"use strict";var express=require("express"),bcrypt=require("bcrypt"),jwt=require("jsonwebtoken"),User=require("../models/user"),router=express.Router();router.post("/signup",function(r,t,e){bcrypt.hash(r.body.password,10).then(function(e){var s=new User({fullname:r.body.fullname,email:r.body.email,password:e});console.log("this user is created: "),console.log(s),s.save().then(function(e){t.status(201).json({message:"user created1",result:e})}).catch(function(e){t.status(500).json({error:e})})})}),router.post("/login",function(s,r,e){var t;User.findOne({email:s.body.email}).then(function(e){return e?(t=e,bcrypt.compare(s.body.password,e.password)):r.status(401).json({message:"auth failed"})}).then(function(e){if(!e)return r.status(401).json({message:"auth failed!"});var s=jwt.sign({email:t.email,userId:t._id},"secret_hehe",{expiresIn:"1h"});r.status(200).json({token:s,expiresIn:3600,userId:t._id})}).catch(function(e){return r.status(401).json({message:"auth failed in catch block!"})})}),module.exports=router;